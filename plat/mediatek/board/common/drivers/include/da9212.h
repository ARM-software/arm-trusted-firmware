/*
 * Copyright (c) 2015, ARM Limited and Contributors. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * Neither the name of ARM nor the names of its contributors may be used
 * to endorse or promote products derived from this software without specific
 * prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */
#ifndef __BOARD_DRIVER_EXT_BUCK_DA9212_H__
#define __BOARD_DRIVER_EXT_BUCK_DA9212_H__

#include <board_params.h>

enum {
	/* Page selection */
	DA9212_REG_PAGE_CON = 0x00,

	/* GPIO Control Registers */
	DA9212_REG_GPIO_0_1 = 0x58,
	DA9212_REG_GPIO_2_3 = 0x59,
	DA9212_REG_GPIO_4 = 0x5A,

	/* Regulator Registers */
	DA9212_REG_BUCKA_CONT = 0x5D,
	DA9212_REG_BUCKB_CONT = 0x5E,
	DA9212_REG_BUCK_ILIM = 0xD0,
	DA9212_REG_BUCKA_CONF = 0xD1,
	DA9212_REG_BUCKB_CONF = 0xD2,
	DA9212_REG_BUCK_CONF = 0xD3,
	DA9212_REG_VBUCKA_MAX = 0xD5,
	DA9212_REG_VBUCKB_MAX = 0xD6,
	DA9212_REG_VBUCKA_A = 0xD7,
	DA9212_REG_VBUCKA_B = 0xD8,
	DA9212_REG_VBUCKB_A = 0xD9,
	DA9212_REG_VBUCKB_B = 0xDA,

	/* I2C Interface Settings */
	DA9212_REG_INTERFACE = 0x105,

	/* OTP */
	DA9212_REG_OPT_COUNT = 0x140,
	DA9212_REG_OPT_ADDR = 0x141,
	DA9212_REG_OPT_DATA = 0x142,

	/* Customer Trim and Configuration */
	DA9212_REG_CONFIG_A = 0x143,
	DA9212_REG_CONFIG_B = 0x144,
	DA9212_REG_CONFIG_C = 0x145,
	DA9212_REG_CONFIG_D = 0x146,
	DA9212_REG_CONFIG_E = 0x147,
	DA9212_REG_INTERFACE3 = 0x149
};

/* DA9212_REG_PAGE_CON (addr=0x00) */
enum {
	DA9212_REG_PAGE_SHIFT = 0,
	DA9212_PEG_PAGE_REVERT_SHIFT = 7,
	DA9212_REG_PAGE_MASK = 0x0F
};

enum {
	DA9212_REG_PAGE0 = 0,
	DA9212_REG_PAGE2 = 2,
	DA9212_REG_PAGE4 = 4,
	DA9212_PAGE_WRITE_MODE = 0x00,
	DA9212_REPEAT_WRITE_MODE = 0x40,
	DA9212_PAGE_REVERT = 0x80
};

/* DA9212_REG_STATUS_A (addr=0x50) */
enum {
	DA9212_GPI0 = 0x01,
	DA9212_GPI1 = 0x02,
	DA9212_GPI2 = 0x04,
	DA9212_GPI3 = 0x08,
	DA9212_GPI4 = 0x10
};

/* DA9212_REG_EVENT_A (addr=0x52) */
enum {
	DA9212_E_GPI0 = 0x01,
	DA9212_E_GPI1 = 0x02,
	DA9212_E_GPI2 = 0x04,
	DA9212_E_GPI3 = 0x08,
	DA9212_E_GPI4 = 0x10
};

/* DA9212_REG_EVENT_B (addr=0x53) */
enum {
	DA9212_E_NPWRGOOD_A = 0x01,
	DA9212_E_NPWRGOOD_B = 0x02,
	DA9212_E_TEMP_WARN = 0x04,
	DA9212_E_TEMP_CRIT = 0x08,
	DA9212_E_OVCURR_A = 0x10,
	DA9212_E_OVCURR_B = 0x20
};

/* DA9212_REG_MASK_A (addr=0x54) */
enum {
	DA9212_M_GPI0 = 0x01,
	DA9212_M_GPI1 = 0x02,
	DA9212_M_GPI2 = 0x04,
	DA9212_M_GPI3 = 0x08,
	DA9212_M_GPI4 = 0x10,
	DA9212_M_UVLO_IO = 0x40
};

/* DA9212_REG_MASK_B (addr=0x55) */
enum {
	DA9212_M_NPWRGOOD_A = 0x01,
	DA9212_M_NPWRGOOD_B = 0x02,
	DA9212_M_TEMP_WARN = 0x04,
	DA9212_M_TEMP_CRIT = 0x08,
	DA9212_M_OVCURR_A = 0x10,
	DA9212_M_OVCURR_B = 0x20
};

/* DA9212_REG_CONTROL_A (addr=0x56) */
enum {
	DA9212_DEBOUNCING_SHIFT = 0,
	DA9212_DEBOUNCING_MASK = 0x07,
	DA9212_SLEW_RATE_A_SHIFT = 0x3,
	DA9212_SLEW_RATE_A_MASK = 0x18,
	DA9212_SLEW_RATE_B_SHIFT = 0x5,
	DA9212_SLEW_RATE_B_MASK = 0x60,
	DA9212_V_LOCK = 0x80
};

/* DA9212_REG_GPIO_0_1 (addr=0x58) */
enum {
	DA9212_GPIO0_PIN_SHIFT = 0,
	DA9212_GPIO0_PIN_MASK = 0x03,
	DA9212_GPIO0_PIN_GPI = 0x00,
	DA9212_GPIO0_PIN_GPO_OD = 0x02,
	DA9212_GPIO0_PIN_GPO = 0x03,
	DA9212_GPIO0_TYPE = 0x04,
	DA9212_GPIO0_TYPE_GPI = 0x00,
	DA9212_GPIO0_TYPE_GPO = 0x04,
	DA9212_GPIO0_MODE = 0x08,
	DA9212_GPIO1_PIN_SHIFT = 4,
	DA9212_GPIO1_PIN_MASK = 0x30,
	DA9212_GPIO1_PIN_GPI = 0x00,
	DA9212_GPIO1_PIN_VERROR = 0x10,
	DA9212_GPIO1_PIN_GPO_OD = 0x20,
	DA9212_GPIO1_PIN_GPO = 0x30,
	DA9212_GPIO1_TYPE_SHIFT = 0x40,
	DA9212_GPIO1_TYPE_GPI = 0x00,
	DA9212_GPIO1_TYPE_GPO = 0x40,
	DA9212_GPIO1_MODE = 0x80
};

/* DA9212_REG_GPIO_2_3 (addr=0x59) */
enum {
	DA9212_GPIO2_PIN_SHIFT = 0,
	DA9212_GPIO2_PIN_MASK = 0x03,
	DA9212_GPIO2_PIN_GPI = 0x00,
	DA9212_GPIO5_PIN_BUCK_CLK = 0x10,
	DA9212_GPIO2_PIN_GPO_OD = 0x02,
	DA9212_GPIO2_PIN_GPO = 0x03,
	DA9212_GPIO2_TYPE = 0x04,
	DA9212_GPIO2_TYPE_GPI = 0x00,
	DA9212_GPIO2_TYPE_GPO = 0x04,
	DA9212_GPIO2_MODE = 0x08,
	DA9212_GPIO3_PIN_SHIFT = 4,
	DA9212_GPIO3_PIN_MASK = 0x30,
	DA9212_GPIO3_PIN_GPI = 0x00,
	DA9212_GPIO3_PIN_IERROR = 0x10,
	DA9212_GPIO3_PIN_GPO_OD = 0x20,
	DA9212_GPIO3_PIN_GPO = 0x30,
	DA9212_GPIO3_TYPE_SHIFT = 0x40,
	DA9212_GPIO3_TYPE_GPI = 0x00,
	DA9212_GPIO3_TYPE_GPO = 0x40,
	DA9212_GPIO3_MODE = 0x80
};

/* DA9212_REG_GPIO_4_5 (addr=0x5A) */
enum {
	DA9212_GPIO4_PIN_SHIFT = 0,
	DA9212_GPIO4_PIN_MASK = 0x03,
	DA9212_GPIO4_PIN_GPI = 0x00,
	DA9212_GPIO4_PIN_GPO_OD = 0x02,
	DA9212_GPIO4_PIN_GPO = 0x03,
	DA9212_GPIO4_TYPE = 0x04,
	DA9212_GPIO4_TYPE_GPI = 0x00,
	DA9212_GPIO4_TYPE_GPO = 0x04,
	DA9212_GPIO4_MODE = 0x08
};

/* DA9212_REG_BUCKA/B_CONT (addr=0x5D/0x5E) */
enum {
	DA9212_BUCK_EN_SHIFT = 0,
	DA9212_BUCK_OFF = 0x00,
	DA9212_BUCK_ON = 0x01,
	DA9212_BUCK_EN = 0x01,
	DA9212_BUCK_GPI_SHIFT = 1,
	DA9212_BUCK_GPI_MASK = 0x06,
	DA9212_BUCK_GPI_OFF = 0x00,
	DA9212_BUCK_GPI_GPIO0 = 0x02,
	DA9212_BUCK_GPI_GPIO1 = 0x04,
	DA9212_BUCK_GPI_GPIO3 = 0x06,
	DA9212_BUCK_PD_DIS = 0x08,
	DA9212_VBUCK_SEL_SHIFT = 4,
	DA9212_VBUCK_SEL = 0x10,
	DA9212_VBUCK_SEL_A = 0x00,
	DA9212_VBUCK_SEL_B = 0x10,
	DA9212_VBUCK_GPI_SHIFT = 5,
	DA9212_VBUCK_GPI_MASK = 0x60,
	DA9212_VBUCK_GPI_OFF = 0x00,
	DA9212_VBUCK_GPI_GPIO1 = 0x20,
	DA9212_VBUCK_GPI_GPIO2 = 0x40,
	DA9212_VBUCK_GPI_GPIO4 = 0x60
};

/* DA9212_REG_BUCK_ILIM (addr=0xD0) */
enum {
	DA9212_BUCK_ILIM_SHIFT = 0,
	DA9212_BUCK_ILIM_MASK = 0x0F,
	DA9212_BUCK_IALARM = 0x10
};

/* DA9212_REG_BUCKA/B_CONF (addr=0xD1/0xD2) */
enum {
	DA9212_BUCK_MODE_SHIFT = 0,
	DA9212_BUCK_MODE_MASK = 0x03,
	DA9212_BUCK_MODE_MANUAL = 0x00,
	DA9212_BUCK_MODE_PFM = 0x01,
	DA9212_BUCK_MODE_PWM = 0x02,
	DA9212_BUCK_MODE_AUTO = 0x03,
	DA9212_BUCK_STARTUP_CTRL_SHIFT = 2,
	DA9212_BUCK_STARTUP_CTRL_MASK = 0x1C,
	DA9212_BUCK_PWR_DOWN_CTRL_SHIFT = 5,
	DA9212_BUCK_PWR_DOWN_CTRL_MASK = 0xE0
};

/* DA9212_REG_BUCK_CONF (addr=0xD3) */
enum {
	DA9212_PHASE_SEL_A_SHIFT = 0,
	DA9212_PHASE_SEL_A_MASK = 0x03,
	DA9212_PHASE_SEL_B_SHIFT = 2,
	DA9212_PHASE_SEL_B_MASK = 0x04,
	DA9212_PH_SH_EN_A = 3,
	DA9212_PH_SH_EN_A_MASK = 0x08,
	DA9212_PH_SH_EN_B = 4,
	DA9212_PH_SH_EN_B_MASK = 0x10
};

/* DA9212_REG_VBUCKA/B_MAX (addr=0xD5/0xD6) */
enum {
	DA9212_VBUCK_MAX_SHIFT = 0,
	DA9212_VBUCK_MAX_MASK = 0x7F
};

/* DA9212_REG_VBUCK_A/B (addr=0xD7/0xD8/0xD9/0xDA) */
enum {
	DA9212_VBUCK_SHIFT = 0,
	DA9212_VBUCK_MASK = 0x7F,
	DA9212_VBUCK_BIAS = 0,
	DA9212_BUCK_SL = 0x80
};

/* DA9212_REG_INTERFACE (addr=0x105) */
enum {
	DA9212_IF_BASE_ADDR_SHIFT = 4,
	DA9212_IF_BASE_ADDR_MASK = 0xF0
};

/* DA9212_REG_CONFIG_E (addr=0x147) */
enum {
	DA9212_STAND_ALONE = 0x01,
	/* DEVICE IDs */
	DA9212_DEVICE_ID = 0x201,
	DA9212_ID	 = 0x22,
	DA9213_ID	 = 0x23,
	DA9212_VARIANT_ID = 0x202,
	DA9212_VARIANT_ID_AB = 0x10,
	DA9212_VARIANT_ID_AC = 0x20
};

/* initialize da9212 */
int da9212_init(void *sub_param);

/* enable or disable da9212 */
void da9212_ctrl(int enable);

#endif /* __BOARD_DRIVER_EXT_BUCK_DA9212_H__ */
